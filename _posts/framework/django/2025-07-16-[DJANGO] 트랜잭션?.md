---
layout: single
title: "📘[Django] Django JsonResponse safe 속성?"
toc: true
toc_sticky: true
toc_label: "목차"
categories: django
excerpt: ""
tag: [rest_api]
---


# 트랜잭션이란?

`트랜잭션`이란, `DB의 상태를 변경시키는 작업의 단위`라고 생각하면 된다.

즉, 한꺼번에 수행되어야 할 연산을 모아놓은 것임.

이 연산 묶음이 처리되지 못하면 원상태로 복구된다는 것이 특징이다. (작업의 일부만 적용되는 현상 방지)

이런 특징 때문에 트랜잭션은 작업의 `완전성`을 보장해준다.

트랜잭션은 크게 4가지 특징을 갖고있는데, `ACID`로 잘 알려져있음.

## Atomicity (원자성)

트랜잭션이 DB에 모두 반영되거나, 혹은 전혀 반영되지 않아야 함.

## Consistenty (일관성)

트랜잭션의 작업 처리 결과는 항상 일관성 있어야 함.

시스템이 갖고있는 고정 요소는 트랜잭션 수행 전과 수행 후의 상태가 같아야한다는 의미로, `DB의 제약조건을 위배하는 작업을 트랜잭션 과정에서 수행할 수 없음`을 나타냄.

## Isolation (독립성)

둘 이상의 트랜잭션이 동시에 병행 실행되고 있을 때, 어떤 트랜잭션도 다른 트랜잭션 연산에 끼어들 수 없음.

## Durability (지속성)

트랜잭션이 성공적으로 완료되었다면, 결과는 영구적으로 반영되어야 함.

# 트랜잭션의 연산?

트랜잭션은 연산의 묶음이라고 했다.

연산에는 어떤 것들이 있을까?

## COMMIT 연산

`트랜잭션이 성공적으로 수행되었음을 선언하는 연산`

`COMMIT` 연산의 실행을 통해 트랜잭션의 수행이 성공적으로 완료되었음을 선언하고, 그 결과를 최종적으로 DB에 반영함.

## ROLLBACK 연산

`트랜잭션 수행이 실패했음을 선언하고, 작업을 취소하는 연산`

트랜잭션이 수행되는 도중 일부 연산이 처리되지 못한 상황이라면, `ROLLBACK` 연산을 실행하여 트랜잭션 수행이 실패했음을 선언하고, DB를 트랜잭션 수행 전과 일관된 상태로 되돌려야 함.

# 트랜잭션의 상태?

트랜잭션은 작업의 성공 여부에 따라 구분할 수 있음.

<img width="712" height="190" alt="Image" src="https://github.com/user-attachments/assets/d79bf7cb-9917-4b7a-ac32-d02234d90d5f" />

## Active

트랜잭션 활동 상태를 말함.

트랜잭션이 실행 중인 상태.

## Partially Committed

트랜잭션의 `COMMIT` 명령이 도착한 상태.

트랜잭션의 `COMMIT` 이전 SQL문이 실행되고, `COMMIT` 만 남은 상태를 말함.

즉, 트랜잭션의 마지막 연산까지 실행하고, `COMMIT` 연산을 실행하기 직전의 상태임.

## Failed

트랜잭션 실패 상태를 말함.

더이상 트랜잭션이 정상적으로 진행될 수 없는 상태임.

## Committed

트랜잭션 완료 상태를 말함.

트랜잭션이 정상적으로 완료됨.

> Partially Committed와 뭐가 다르지?
`COMMIT` 요청이 들어오면, `Partially Committed` 상태가 됨.
이후 `COMMIT`을 문제없이 수행할 수 있으면 `Committed` 상태로 전이되고, 오류가 발생한다면 `Failed` 상태로 됨.
즉, `Partially Committed`는 `COMMIT` 요청이 들어왔을 때를 말하는거고, `Committed`는 `COMMIT`을 정상적으로 완료한 상태를 말하는거임!
> 

## Aborted

트랜잭션 취소 상태를 말함.

트랜잭션이 취소되고, 트랜잭션 실행 이전 데이터로 돌아간 상태임.

즉, 트랜잭션 수행이 실패하고 `ROLLBACK` 연산이 실행된 상태인거임.

# 트랜잭션은 항상 써야되나? 주의할 점

트랜잭션은 꼭 필요한 최소한의 코드에만 사용하는 것이 좋음. (적재적소에 사용하자)

즉, 트랜잭션의 범위를 최소화하라는 말임!

일반적으로 DB 커넥션은 개수가 제한적임.

그런데 각 단위 프로그램이 커넥션을 소유하는 시간이 길어지면, 사용 가능한 여유 커넥션의 개수는 줄어들게되고, 그러다면 오느 순간에 각 단위 프로그램에서 커넥션을 가져가기 위해 기다려야하는 상황이 발생할 수 있기 때문임.

👉 [[DB] transaction을 적용해야될 때와 하지 않아야할 때?](https://www.notion.so/DB-transaction-214abd2e773f801f807eeed93cf02d99?pvs=21) 

# 참고 자료

https://velog.io/@shasha/Database-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%95%EB%A6%AC#5-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%82%AC%EC%9A%A9-%EC%8B%9C-%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90