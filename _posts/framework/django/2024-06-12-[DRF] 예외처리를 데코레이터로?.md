---
layout: single
title: "ğŸ“˜[DRF] ì˜ˆì™¸ì²˜ë¦¬ë¥¼ ë°ì½”ë ˆì´í„°ë¡œ?"
toc: true
toc_sticky: true
toc_label: "ëª©ì°¨"
categories: django
excerpt: ""
tag: [python, drf]
---

# try ~ except ì ˆì„ ë°ì½”ë ˆì´í„°ë¡œ ê´€ë¦¬í•´ë³´ì!

í”„ë¡œì íŠ¸ ì§„í–‰ ë„ì¤‘, `ì˜ˆì™¸ì²˜ë¦¬`ë¡œì§ì„ ë”°ë¡œ ë¶„ë¦¬í•´ì„œ ê´€ë¦¬í•˜ë©´ `view(or controller)`ì—ì„œ ë°˜ë³µì ì¸ ì˜ˆì™¸ì²˜ë¦¬ ë¡œì§ì´ í•„ìš” ì—†ì–´ì ¸ ê°€ë…ì„±ì´ ì¢‹ì•„ì§ˆê±° ê°™ë‹¤ëŠ” í”¼ë“œë°±ì„ ë°›ì•˜ë‹¤!

ê·¸ë˜ì„œ djangoì—ì„œ ë°ì½”ë ˆì´í„°ë¥¼ ë§Œë“¤ì–´, í•´ë‹¹ ë°ì½”ë ˆì´í„°ë¥¼ í†µí•´ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ ì§„í–‰í•˜ë„ë¡ ìˆ˜ì •í–ˆë‹¤!

## ë°ì½”ë ˆì´í„°ë¥¼ ë§Œë“œëŠ”ê±´ ì–´ë–»ê²Œ í• ê¹Œ?

ìš°ì„ , djangoì—ì„œ ë°ì½”ë ˆì´í„°ë¥¼ ë§Œë“œëŠ” ë°©ë²•ë¶€í„° ì•Œì•„ë³´ì!

```python
from functools import wraps

def my_decorator(func):
    @wraps(func)
    def wrapper(*args, **kwargs):
        # ë°ì½”ë ˆì´í„°ê°€ í•˜ëŠ” ì¼
        result = func(*args, **kwargs)
        return result
    return wrapper
```

ì´ë ‡ê²Œ ì‘ì„±í•˜ë©´, ë‹¤ë¥¸ íŒŒì¼ì—ì„œ `@my_decorator` ë¥¼ ì ì–´ ë°ì½”ë ˆì´í„°ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.

```python
@my_decorator
def say_hello(name):
    return f"Hello, {name}!"
   
   
print(say_hello("Alice"))  # "Calling function say_hello"ì™€ "Hello, Alice!" ì¶œë ¥
print(say_hello.__name__)  # "say_hello" ì¶œë ¥
print(say_hello.__doc__)   # "Greet someone with their name." ì¶œë ¥
```

## ë‚´ê°€ ì ì–´ë³¸ ë°ì½”ë ˆì´í„°!

```python
def exception_handler(view: bool = False):
    def exception_handler_decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            try:
                return func(*args, **kwargs)
            except Card.DoesNotExist as e:
                print(f"An error occurred in {func.__name__}: {e}")
                return error_response("Invalid Card", status.HTTP_400_BAD_REQUEST)
            except Game.DoesNotExist as e:
                print(f"An error occuerd in {func.__name__}: {e}")
                return error_response("Invalid Game", status.HTTP_400_BAD_REQUEST)
            except Gametype.DoesNotExist as e:
                print(f"An error occurred in {func.__name__}: {e}")
                return error_response("Invalid Game Type", status.HTTP_400_BAD_REQUEST)
            except AIAnswer.DoesNotExist as e:
                print(f"An error occurred in {func.__name__}: {e}")
                return error_response("Invalid AI Answer", status.HTTP_400_BAD_REQUEST)
            except Exception as e:
                print(f"An error occurred in {func.__name__}: {e}")
                return error_response("Internal Server Error", status.HTTP_500_INTERNAL_SERVER_ERROR)
        return wrapper
    return exception_handler_decorator
```

- `def exception_handler(view: bool = False):`
    - viewsì—ì„œ ì‚¬ìš©í•  ë°ì½”ë ˆì´í„°ë¥¼ ì •ì˜í•œë‹¤.
    - `view: bool = False`: ë§Œì•½ ì´ ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•œ functionì´ viewì¸ì§€ ì•„ë‹Œì§€ ê²€ì‚¬í•œë‹¤. ê¸°ë³¸ ê°’ì€ False
- `@wraps(func)`
    - Pythonì—ì„œ ë°ì½”ë ˆì´í„°ë¥¼ ì •ì˜í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë„êµ¬ë¡œ, `functools` ëª¨ë“ˆì—ì„œ ì œê³µëœë‹¤.
    - ë°ì½”ë ˆì´íŠ¸ëœ í•¨ìˆ˜ê°€ ì›ë˜ `í•¨ìˆ˜ì˜ ì´ë¦„`, `ë¬¸ì„œ ë¬¸ìì—´(docstring)`, `ì£¼ì„`, ë° `ê¸°íƒ€ ì†ì„±`ì„ ìƒì§€ ì•Šë„ë¡ í•œë‹¤.
- `def wrapper(*args, **kwargs)`
    - `wrapper` í•¨ìˆ˜ëŠ” ì›ë˜ í•¨ìˆ˜(`func`)ë¥¼ ë˜í•‘í•˜ì—¬ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì¶”ê°€í•œë‹¤.
    - `*args`ì™€ `**kwargs`ëŠ” ì›ë˜ í•¨ìˆ˜ì˜ ëª¨ë“  ì¸ìë¥¼ ê·¸ëŒ€ë¡œ ë°›ëŠ”ë‹¤.
    - ë³¸ê²©ì ì¸ ì˜ˆì™¸ì²˜ë¦¬ ë¡œì§ì„ ìˆ˜í–‰í•œë‹¤.
- `try ~ except`
    - `return func(*args, **kwargs)`: ì›ë˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.
    - ì´í›„ì—ëŠ” ë°ì´í„° ì¡´ì¬ ì—¬ë¶€ì˜ ì˜ˆì™¸ì²˜ë¦¬ì™€ ê·¸ ì™¸ì˜ ì˜ˆì™¸ëŠ” ì œë„¤ë¦­í•˜ê²Œ ë°›ì•„ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•œë‹¤.

### ë‚´ê°€ ë§Œë“  ë°ì½”ë ˆì´í„°ì—ì„œ ì“´ error_responseëŠ” ë­ì§€?

```python
from rest_framework import status
from rest_framework.response import Response

def error_response(error: str, status_code: int):
    return Response({"error": error}, status_code)
```

- ì¸ìë¡œ `ì—ëŸ¬ ë©”ì‹œì§€(error)`ì™€ `HTTP ìƒíƒœ ì½”ë“œ(status_code)`ë¥¼ ë°›ëŠ”ë‹¤.
- ì‚¬ìš©ìì—ê²ŒëŠ” `{"error": error}` í¬ë©§ì˜ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì£¼ê³ , ìƒíƒœ ì½”ë“œë¥¼ ì „ë‹¬í•œë‹¤.

# ë°ì½”ë ˆì´í„° ë™ì‘ ìˆœì„œ?

í•˜ë‚˜ì˜ ë™ì‘(í•¨ìˆ˜)ì„ ìˆ˜í–‰í•  ë•Œ, ì—¬ëŸ¬ ê°€ì§€ì˜ ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ê·¸ëŸ°ë°, ì—¬ëŸ¬ ê°œì˜ ë°ì½”ë ˆì´í„°ê°€ ë¶™ì–´ìˆìœ¼ë©´ ì´ ë°ì½”ë ˆì´í„°ë“¤ì´ ì–´ë–¤ ìˆœì„œë¥¼ ê°–ê³  ë™ì‘í•˜ëŠ”ì§€ë¥¼ ì•Œì•„ì•¼ ë‚´ê°€ ë°ì½”ë ˆì´í„°ë¥¼ ë§Œë“¤ì–´ ì ì ˆí•˜ê²Œ ì“¸ ìˆ˜ ìˆë‹¤!

![KakaoTalk_Photo_2024-06-13-03-45-18](https://github.com/TUK-3oon/hello-tarot-BE/assets/104587537/dd91591e-e94f-4ffb-b106-1d3e65a5be75)


ìœ„ì˜ ì˜ˆì‹œë¥¼ ë³´ë©´ ì´í•´ê°€ ì‰½ë‹¤!

í•¨ìˆ˜ê°€ ë¨¼ì € ì‹¤í–‰ë˜ê³ , ìœ„ì— ìˆëŠ” ë°ì½”ë ˆì´í„° â†’ ê·¸ ìœ„ì˜ ë°ì½”ë ˆì´í„° ìˆœìœ¼ë¡œ ë™ì‘í•˜ê²Œ ëœë‹¤.

ì´ í¬ìŠ¤íŒ…ì—ì„œ ì‘ì„±í•œ ì˜ˆì‹œëŠ” ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°ì½”ë ˆì´í„°ì˜€ìœ¼ë‹ˆ, í•¨ìˆ˜ê°€ ë™ì‘í•˜ê³  ê·¸ ê²°ê³¼ì— ëŒ€í•œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ ë°”ë¡œ ì²˜ë¦¬í•´ì•¼í•˜ë¯€ë¡œ, í•¨ìˆ˜ ë°”ë¡œ ìœ„ì— ì„ ì–¸í–ˆë‹¤.